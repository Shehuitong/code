@env="global"

### 1. ã€å‰ç½®ã€‘ç”¨æˆ·4ï¼ˆèµµå…­ï¼Œç”µæ°”å­¦é™¢2025çº§ï¼‰ç™»å½•ï¼ˆè·å–Tokenï¼‰
POST http://localhost:8080/login
Content-Type: application/json

{
  "account": "202500422",
  "password": "Aa202500422"
}
> {%
    try {
        const resBody = response.body || {};
        if (resBody.code === 200 && resBody.data && resBody.data.token) {
            client.global.set("user4Token", resBody.data.token);
            console.log("âœ… ç”¨æˆ·4ç™»å½•æˆåŠŸï¼ŒTokenï¼š" + resBody.data.token.substring(0, 20) + "..."); // æ‰“å°Tokenå‰20ä½éªŒè¯
        } else {
            console.error("âŒ ç”¨æˆ·4ç™»å½•å¤±è´¥ï¼š" + (resBody.message || "æœªçŸ¥é”™è¯¯") + "ï¼Œå“åº”ä½“ï¼š" + JSON.stringify(resBody));
        }
    } catch (e) {
        console.error("âŒ ç”¨æˆ·4ç™»å½•è„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}


### 2. ã€å‰ç½®ã€‘ç”¨æˆ·2ï¼ˆæå››ï¼Œè®¡ç®—æœºå­¦é™¢2023çº§ï¼‰ç™»å½•ï¼ˆè·å–Tokenï¼‰
POST http://localhost:8080/login
Content-Type: application/json

{
  "account": "202300208",
  "password": "Aa202300208"
}
> {%
    try {
        const resBody = response.body || {};
        if (resBody.code === 200 && resBody.data && resBody.data.token) {
            client.global.set("user2Token", resBody.data.token);
            console.log("âœ… ç”¨æˆ·2ç™»å½•æˆåŠŸï¼ŒTokenå·²è®¾ç½®");
        } else {
            console.error("âŒ ç”¨æˆ·2ç™»å½•å¤±è´¥ï¼š" + (resBody.message || "æœªçŸ¥é”™è¯¯") + "ï¼Œå“åº”ä½“ï¼š" + JSON.stringify(resBody));
        }
    } catch (e) {
        console.error("âŒ ç”¨æˆ·2ç™»å½•è„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}


### 3. ã€å‰ç½®ã€‘ç®¡ç†å‘˜ï¼ˆå¼ ç®¡ç†å‘˜ï¼‰ç™»å½•ï¼ˆè·å–Tokenï¼‰
POST http://localhost:8080/login
Content-Type: application/json

{
  "account": "G2025001",
  "password": "Admin123"
}
> {%
    try {
        const resBody = response.body || {};
        if (resBody.code === 200 && resBody.data && resBody.data.token) {
            client.global.set("adminToken", resBody.data.token);
            console.log("âœ… ç®¡ç†å‘˜ç™»å½•æˆåŠŸï¼ŒTokenå·²è®¾ç½®");
        } else {
            console.error("âŒ ç®¡ç†å‘˜ç™»å½•å¤±è´¥ï¼š" + (resBody.message || "æœªçŸ¥é”™è¯¯") + "ï¼Œå“åº”ä½“ï¼š" + JSON.stringify(resBody));
        }
    } catch (e) {
        console.error("âŒ ç®¡ç†å‘˜ç™»å½•è„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}


### 4. ã€å‰ç½®ã€‘ç”¨æˆ·1ï¼ˆå¼ ä¸‰ï¼Œå¤–å›½è¯­å­¦é™¢2022çº§ï¼‰ç™»å½•ï¼ˆè·å–Tokenï¼‰
POST http://localhost:8080/login
Content-Type: application/json

{
  "account": "202200101",
  "password": "Aa202200101"
}
> {%
    try {
        const resBody = response.body || {};
        if (resBody.code === 200 && resBody.data && resBody.data.token) {
            client.global.set("user1Token", resBody.data.token);
            console.log("âœ… ç”¨æˆ·1ç™»å½•æˆåŠŸï¼ŒTokenå·²è®¾ç½®");
        } else {
            console.error("âŒ ç”¨æˆ·1ç™»å½•å¤±è´¥ï¼š" + (resBody.message || "æœªçŸ¥é”™è¯¯") + "ï¼Œå“åº”ä½“ï¼š" + JSON.stringify(resBody));
        }
    } catch (e) {
        console.error("âŒ ç”¨æˆ·1ç™»å½•è„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}


### 5. æŸ¥è¯¢æ´»åŠ¨1ï¼ˆç¨‹åºè®¾è®¡ç«èµ›ï¼‰åˆå§‹ä¿¡æ¯ï¼ˆéªŒè¯æ´»åŠ¨å­˜åœ¨æ€§ï¼‰
###3. æ´»åŠ¨è¯¦æƒ…æ¥å£
GET http://localhost:8080/api/activity/detail/1

### 6. ç”¨æˆ·4ï¼ˆ2025çº§ï¼‰æŠ¥åæ´»åŠ¨1ï¼ˆæ˜¾å¼ä¼ é€’è¯·æ±‚ä½“å‚æ•°ï¼‰
POST http://localhost:8080/api/registration/activity/1
Authorization: Bearer {{user4Token}}
Content-Type: application/json

{
  "activityId": 1,
  "userId": 4
}

> {%
    try {
        const contentType = response.headers.get("Content-Type") || "";
        if (contentType.includes("text/html")) {
            console.error("âŒ æŠ¥åæ¥å£è¿”å›HTMLé”™è¯¯é¡µï¼šçŠ¶æ€ç =" + response.status + "ï¼Œå“åº”å†…å®¹ï¼š" + response.body);
        } else {
            const resBody = response.body || {};
            console.log("ğŸ” ç”¨æˆ·4æŠ¥åå“åº”ä½“ï¼š" + JSON.stringify(resBody)); // æ‰“å°å®Œæ•´å“åº”å®šä½é”™è¯¯
            if (resBody.code === 200) {
                console.log("âœ… ç”¨æˆ·4æŠ¥åæ´»åŠ¨1æˆåŠŸï¼š" + resBody.message);
            } else {
                console.error("âŒ ç”¨æˆ·4æŠ¥åæ´»åŠ¨1å¤±è´¥ï¼š" + (resBody.message || "æœªçŸ¥é”™è¯¯") + "ï¼Œå“åº”ç =" + resBody.code + "ï¼Œé”™è¯¯è¯¦æƒ…=" + (resBody.data || "æ— "));
            }
        }
    } catch (e) {
        console.error("âŒ ç”¨æˆ·4æŠ¥åè„šæœ¬é”™è¯¯ï¼š" + e.message + "ï¼Œé”™è¯¯æ ˆï¼š" + e.stack);
    }
%}

###
GET http://localhost:8080/api/registration/user-details
Authorization: Bearer {{user4Token}}
Content-Type: application/json


### 7. éªŒè¯æ´»åŠ¨1åé¢å˜åŒ–ï¼ˆå‰©ä½™-1ï¼Œå·²æŠ¥å+1ï¼‰
###3. æ´»åŠ¨è¯¦æƒ…æ¥å£
GET http://localhost:8080/api/activity/detail/1

### 8. ç”¨æˆ·4é‡å¤æŠ¥åæ´»åŠ¨1ï¼ˆä¸šåŠ¡æ ¡éªŒï¼‰
POST http://localhost:8080/api/registration/activity/1
Authorization: Bearer {{user4Token}}
Content-Type: application/json

{
  "activityId": 1,
  "userId": 4
}

> {%
    try {
        const contentType = response.headers.get("Content-Type") || "";
        if (contentType.includes("text/html")) {
            console.error("âŒ é‡å¤æŠ¥åæ¥å£è¿”å›HTMLé”™è¯¯é¡µï¼šçŠ¶æ€ç =" + response.status);
        } else {
            const resBody = response.body || {};
            console.log("ğŸ” ç”¨æˆ·4é‡å¤æŠ¥åå“åº”ä½“ï¼š" + JSON.stringify(resBody));
            if (resBody.code !== 200 && resBody.message && resBody.message.includes("å·²æŠ¥å")) {
                console.log("âœ… é‡å¤æŠ¥åæ ¡éªŒé€šè¿‡ï¼š" + resBody.message);
            } else {
                console.error("âŒ é‡å¤æŠ¥åæ ¡éªŒå¤±è´¥ï¼š" + (resBody.message || "æœªæ‹¦æˆªé‡å¤æŠ¥å") + "ï¼Œå“åº”ç =" + resBody.code);
            }
        }
    } catch (e) {
        console.error("âŒ é‡å¤æŠ¥åè„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}


### 9. ç”¨æˆ·4å–æ¶ˆæ´»åŠ¨1æŠ¥å
DELETE http://localhost:8080/api/registration/activity/1
Authorization: Bearer {{user4Token}}
Content-Type: application/json // è¡¥å……Content-Typeï¼ŒåŒ¹é…åç«¯æ¥æ”¶è¦æ±‚

> {%
    try {
        const contentType = response.headers.get("Content-Type") || "";
        if (contentType.includes("text/html")) {
            console.error("âŒ å–æ¶ˆæŠ¥åæ¥å£è¿”å›HTMLé”™è¯¯é¡µï¼šçŠ¶æ€ç =" + response.status);
        } else {
            const resBody = response.body || {};
            console.log("ğŸ” ç”¨æˆ·4å–æ¶ˆæŠ¥åå“åº”ä½“ï¼š" + JSON.stringify(resBody));
            if (resBody.code === 200) {
                console.log("âœ… ç”¨æˆ·4å–æ¶ˆæ´»åŠ¨1æŠ¥åæˆåŠŸï¼š" + resBody.message);
            } else {
                console.error("âŒ ç”¨æˆ·4å–æ¶ˆæŠ¥åå¤±è´¥ï¼š" + (resBody.message || "æœªçŸ¥é”™è¯¯") + "ï¼Œå“åº”ç =" + resBody.code);
            }
        }
    } catch (e) {
        console.error("âŒ ç”¨æˆ·4å–æ¶ˆæŠ¥åè„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}
###
GET http://localhost:8080/api/registration/user-details
Authorization: Bearer {{user4Token}}
Content-Type: application/json

### 10. éªŒè¯æ´»åŠ¨1åé¢æ¢å¤ï¼ˆå‰©ä½™+1ï¼Œå·²æŠ¥å-1ï¼‰
GET http://localhost:8080/api/activity/1
Authorization: Bearer {{adminToken}}
Accept: application/json

> {%
    try {
        const contentType = response.headers.get("Content-Type") || "";
        if (contentType.includes("text/html")) {
            console.error("âŒ æ¥å£è¿”å›HTMLé”™è¯¯é¡µï¼šçŠ¶æ€ç =" + response.status);
        } else {
            const resBody = response.body || {};
            const initialRemaining = client.global.get("activity1Remaining") || 0;
            const initialApplyCount = client.global.get("activity1ApplyCount") || 0;

            if (resBody.code === 200 && resBody.data) {
                const currentRemaining = resBody.data.remainingPeople;
                const currentApplyCount = resBody.data.applyCount;
                const expectedRemaining = initialRemaining + 1;
                const expectedApplyCount = initialApplyCount - 1;

                console.log("ğŸ“Š æ´»åŠ¨1åé¢æ¢å¤å¯¹æ¯”ï¼š");
                console.log("   æ“ä½œå‰å‰©ä½™ï¼š" + initialRemaining + " â†’ å½“å‰å‰©ä½™ï¼š" + currentRemaining + "ï¼ˆé¢„æœŸï¼š" + expectedRemaining + "ï¼‰");
                console.log("   æ“ä½œå‰å·²æŠ¥ï¼š" + initialApplyCount + " â†’ å½“å‰å·²æŠ¥ï¼š" + currentApplyCount + "ï¼ˆé¢„æœŸï¼š" + expectedApplyCount + "ï¼‰");
                console.log((currentRemaining === expectedRemaining && currentApplyCount === expectedApplyCount) ? "âœ… åé¢æ¢å¤æ­£ç¡®" : "âŒ åé¢æ¢å¤é”™è¯¯");
            } else {
                console.error("âŒ æŸ¥è¯¢æ´»åŠ¨1å¤±è´¥ï¼š" + (resBody.message || "å“åº”æ ¼å¼é”™è¯¯") + "ï¼Œå“åº”ä½“ï¼š" + JSON.stringify(resBody));
            }
        }
    } catch (e) {
        console.error("âŒ åé¢æ¢å¤éªŒè¯è„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}


### 11. ç”¨æˆ·4é‡å¤å–æ¶ˆæ´»åŠ¨1æŠ¥åï¼ˆä¸šåŠ¡æ ¡éªŒï¼‰
DELETE http://localhost:8080/api/registration/activity/1
Authorization: Bearer {{user4Token}}
Content-Type: application/json

> {%
    try {
        const contentType = response.headers.get("Content-Type") || "";
        if (contentType.includes("text/html")) {
            console.error("âŒ é‡å¤å–æ¶ˆæ¥å£è¿”å›HTMLé”™è¯¯é¡µï¼šçŠ¶æ€ç =" + response.status);
        } else {
            const resBody = response.body || {};
            const errorMsg = resBody.message || "";
            console.log("ğŸ” ç”¨æˆ·4é‡å¤å–æ¶ˆå“åº”ä½“ï¼š" + JSON.stringify(resBody));
            if (resBody.code !== 200 && (errorMsg.includes("æœªæŠ¥å") || errorMsg.includes("å·²å–æ¶ˆ"))) {
                console.log("âœ… é‡å¤å–æ¶ˆæ ¡éªŒé€šè¿‡ï¼š" + errorMsg);
            } else {
                console.error("âŒ é‡å¤å–æ¶ˆæ ¡éªŒå¤±è´¥ï¼š" + (errorMsg || "æœªæ‹¦æˆªé‡å¤å–æ¶ˆ") + "ï¼Œå“åº”ç =" + resBody.code);
            }
        }
    } catch (e) {
        console.error("âŒ é‡å¤å–æ¶ˆè„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}


### 12. ç”¨æˆ·2ï¼ˆ2023çº§ï¼‰æŠ¥åæ´»åŠ¨1ï¼ˆå¹´çº§ä¸ç¬¦åˆï¼šæ´»åŠ¨1è¦æ±‚2025çº§ï¼‰
POST http://localhost:8080/api/registration/activity/1
Authorization: Bearer {{user2Token}}
Content-Type: application/json

{
  "activityId": 1,
  "userId": 2
}

> {%
    try {
        const contentType = response.headers.get("Content-Type") || "";
        if (contentType.includes("text/html")) {
            console.error("âŒ å¹´çº§æ ¡éªŒæ¥å£è¿”å›HTMLé”™è¯¯é¡µï¼šçŠ¶æ€ç =" + response.status);
        } else {
            const resBody = response.body || {};
            console.log("ğŸ” ç”¨æˆ·2æŠ¥åæ´»åŠ¨1å“åº”ä½“ï¼š" + JSON.stringify(resBody));
            if (resBody.code !== 200 && resBody.message && resBody.message.includes("å¹´çº§")) {
                console.log("âœ… å¹´çº§æ ¡éªŒé€šè¿‡ï¼š" + resBody.message);
            } else {
                console.error("âŒ å¹´çº§æ ¡éªŒå¤±è´¥ï¼š" + (resBody.message || "æœªæ‹¦æˆªä¸ç¬¦åˆå¹´çº§çš„æŠ¥å") + "ï¼Œå“åº”ç =" + resBody.code);
            }
        }
    } catch (e) {
        console.error("âŒ å¹´çº§æ ¡éªŒè„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}


### 13. ç®¡ç†å‘˜æŠ¥åæ´»åŠ¨1ï¼ˆæƒé™æ ¡éªŒï¼‰
POST http://localhost:8080/api/registration/activity/1
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "adminId": 3
}

> {%
    try {
        const contentType = response.headers.get("Content-Type") || "";
        if (contentType.includes("text/html")) {
            console.error("âŒ ç®¡ç†å‘˜æƒé™æ ¡éªŒæ¥å£è¿”å›HTMLé”™è¯¯é¡µï¼šçŠ¶æ€ç =" + response.status);
        } else {
            const resBody = response.body || {};
            console.log("ğŸ” ç®¡ç†å‘˜æŠ¥åå“åº”ä½“ï¼š" + JSON.stringify(resBody));
            if (resBody.code !== 200 && resBody.message && resBody.message.includes("ç®¡ç†å‘˜ä¸å¯å‚ä¸")) {
                console.log("âœ… ç®¡ç†å‘˜æƒé™æ ¡éªŒé€šè¿‡ï¼š" + resBody.message);
            } else {
                console.error("âŒ ç®¡ç†å‘˜æƒé™æ ¡éªŒå¤±è´¥ï¼š" + (resBody.message || "æœªæ‹¦æˆªç®¡ç†å‘˜æŠ¥å") + "ï¼Œå“åº”ç =" + resBody.code);
            }
        }
    } catch (e) {
        console.error("âŒ ç®¡ç†å‘˜æŠ¥åè„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}

### 14. ç”¨æˆ·2æŠ¥åæ´»åŠ¨3ï¼ˆå¿—æ„¿è€…æ‹›å‹Ÿï¼Œ2023çº§å¯æŠ¥ï¼‰
POST http://localhost:8080/api/registration/activity/3
Authorization: Bearer {{user2Token}}
Content-Type: application/json

{
  "activityId": 3,
  "userId": 2
}

> {%
    try {
        const contentType = response.headers.get("Content-Type") || "";
        if (contentType.includes("text/html")) {
            console.error("âŒ ç”¨æˆ·2æŠ¥åæ¥å£è¿”å›HTMLé”™è¯¯é¡µï¼šçŠ¶æ€ç =" + response.status);
        } else {
            const resBody = response.body || {};
            console.log("ğŸ” ç”¨æˆ·2æŠ¥åæ´»åŠ¨3å“åº”ä½“ï¼š" + JSON.stringify(resBody));
            if (resBody.code === 200) {
                console.log("âœ… ç”¨æˆ·2æŠ¥åæ´»åŠ¨3æˆåŠŸï¼š" + resBody.message);
            } else {
                console.error("âŒ ç”¨æˆ·2æŠ¥åæ´»åŠ¨3å¤±è´¥ï¼š" + (resBody.message || "æœªçŸ¥é”™è¯¯") + "ï¼Œå“åº”ç =" + resBody.code);
            }
        }
    } catch (e) {
        console.error("âŒ ç”¨æˆ·2æŠ¥åæ´»åŠ¨3è„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}


### 15. ç”¨æˆ·2æŸ¥è¯¢ä¸ªäººæŠ¥ååˆ—è¡¨
GET http://localhost:8080/api/registration/my
Authorization: Bearer {{user2Token}}
Accept: application/json

> {%
    try {
        const contentType = response.headers.get("Content-Type") || "";
        if (contentType.includes("text/html")) {
            console.error("âŒ æŠ¥ååˆ—è¡¨æ¥å£è¿”å›HTMLé”™è¯¯é¡µï¼šçŠ¶æ€ç =" + response.status);
        } else {
            const resBody = response.body || {};
            console.log("ğŸ” ç”¨æˆ·2æŠ¥ååˆ—è¡¨å“åº”ä½“ï¼š" + JSON.stringify(resBody));
            if (resBody.code === 200) {
                const data = resBody.data || [];
                let hasActivity3 = false;
                for (let i = 0; i < data.length; i++) {
                    console.log("ğŸ“Œ æŠ¥åè®°å½•" + i + "ï¼š" + JSON.stringify(data[i])); // æ‰“å°æ¯æ¡æŠ¥åè®°å½•
                    if (data[i].activityId === 3 || (data[i].activity && data[i].activity.activityId === 3)) {
                        hasActivity3 = true;
                        break;
                    }
                }
                console.log("ç”¨æˆ·2æŠ¥ååˆ—è¡¨æ˜¯å¦åŒ…å«æ´»åŠ¨3ï¼š" + (hasActivity3 ? "âœ… æ˜¯ï¼ˆæ­£ç¡®ï¼‰" : "âŒ å¦ï¼ˆé”™è¯¯ï¼‰"));
            } else {
                console.error("âŒ æŸ¥è¯¢ä¸ªäººæŠ¥ååˆ—è¡¨å¤±è´¥ï¼š" + (resBody.message || "æœªçŸ¥é”™è¯¯") + "ï¼Œå“åº”ç =" + resBody.code);
            }
        }
    } catch (e) {
        console.error("âŒ ä¸ªäººæŠ¥ååˆ—è¡¨æŸ¥è¯¢è„šæœ¬é”™è¯¯ï¼š" + e.message + "ï¼Œé”™è¯¯æ ˆï¼š" + e.stack);
    }
%}


### 16. æ¨¡æ‹Ÿæ´»åŠ¨1åé¢å·²æ»¡ï¼ˆéœ€æ‰‹åŠ¨å°†æ•°æ®åº“ä¸­activity1çš„remaining_peopleæ”¹ä¸º0åæ‰§è¡Œï¼‰
POST http://localhost:8080/api/registration/activity/1
Authorization: Bearer {{user4Token}}
Content-Type: application/json

{
  "activityId": 1,
  "userId": 4
}

> {%
    try {
        const contentType = response.headers.get("Content-Type") || "";
        if (contentType.includes("text/html")) {
            console.error("âŒ åé¢å·²æ»¡æ ¡éªŒæ¥å£è¿”å›HTMLé”™è¯¯é¡µï¼šçŠ¶æ€ç =" + response.status);
        } else {
            const resBody = response.body || {};
            console.log("ğŸ” åé¢å·²æ»¡æ ¡éªŒå“åº”ä½“ï¼š" + JSON.stringify(resBody));
            if (resBody.code !== 200 && resBody.message && resBody.message.includes("åé¢å·²æ»¡")) {
                console.log("âœ… åé¢å·²æ»¡æ ¡éªŒé€šè¿‡ï¼š" + resBody.message);
            } else {
                console.error("âŒ åé¢å·²æ»¡æ ¡éªŒå¤±è´¥ï¼š" + (resBody.message || "æœªæ‹¦æˆªåé¢å·²æ»¡çš„æŠ¥å") + "ï¼Œå“åº”ç =" + resBody.code);
            }
        }
    } catch (e) {
        console.error("âŒ åé¢å·²æ»¡æ ¡éªŒè„šæœ¬é”™è¯¯ï¼š" + e.message);
    }
%}